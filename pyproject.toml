[project]
name = "hpx"
dependencies = [
    "numpy>=1.23, <2",
]
requires-python = ">=3.9"
version = "0.0.1"

[build-system]
build-backend = 'mesonpy'
requires = [
    "meson>=1.4.0",
    "meson-python",
    "numpy>=2.0.0rc1",
]

[tool.cibuildwheel]
build-verbosity = 1

[tool.cibuildwheel.linux]
before-all = [
    "yum install -y boost-devel gmp-devel mpfr-devel",
    "curl -OL https://github.com/CGAL/cgal/releases/download/v5.6.1/CGAL-5.6.1.zip",
    "unzip CGAL-5.6.1.zip",
    "cd CGAL-5.6.1",
    "cmake .",
    "make install"
]

[tool.cibuildwheel.linux.config-settings]
setup-args = "-Dcmake_prefix_path=/usr/local/lib64/cmake"

[tool.cibuildwheel.macos]
before-all = "brew install cgal libomp"

[tool.cibuildwheel.macos.environment]
CC = "$(brew --prefix llvm@15)/bin/clang"
CXX = "$(brew --prefix llvm@15)/bin/clang++"
CPPFLAGS = "-I$(brew --prefix libomp)/include"
LDFLAGS = "-L$(brew --prefix libomp)/lib"

# [tool.cibuildwheel.macos.environment]
# CMAKE = "~/micromamba/bin/cmake"
# CC = "$(brew --prefix llvm@15)/bin/clang"
# CXX = "$(brew --prefix llvm@15)/bin/clang++"
